<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>HTML Form Example</title>
</head>

<body>
    <main>
        <section class="min-h-screen flex">
            <form class="flex gap-2 flex-col m-auto border p-4 rounded w-1/3" novalidate>
                <div class="flex flex-col gap-2">
                    <div class="flex flex-col-reverse gap-2"><input
                            class="p-2 valid:border rounded outline-none invalid:outline invalid:outline-red-600 outline-1 peer"
                            id="admin" label="Admin" name="admin" type="checkbox"> <label
                            class="peer-data-[validation-required=true]:after:content-['*'] after:text-red-500 peer-invalid:text-red-500 text-sm"
                            for="admin">Admin</label></div>
                    <div class="flex flex-col gap-2"></div>
                </div>
                <div class="flex flex-col gap-2">
                    <div class="flex flex-col-reverse gap-2"><input
                            class="p-2 valid:border rounded outline-none invalid:outline invalid:outline-red-600 outline-1 peer"
                            id="givenName" label="Given Name" name="givenName"> <label
                            class="peer-data-[validation-required=true]:after:content-['*'] after:text-red-500 peer-invalid:text-red-500 text-sm"
                            for="givenName">Given Name</label></div>
                    <div class="flex flex-col gap-2"></div>
                </div>
                <div class="flex flex-col gap-2">
                    <div class="flex flex-col-reverse gap-2"><input
                            class="p-2 valid:border rounded outline-none invalid:outline invalid:outline-red-600 outline-1 peer"
                            id="surname" label="Surname" name="surname"> <label
                            class="peer-data-[validation-required=true]:after:content-['*'] after:text-red-500 peer-invalid:text-red-500 text-sm"
                            for="surname">Surname</label></div>
                    <div class="flex flex-col gap-2"></div>
                </div>
                <div class="flex flex-col gap-2">
                    <div class="flex flex-col-reverse gap-2"><input
                            class="p-2 valid:border rounded outline-none invalid:outline invalid:outline-red-600 outline-1 peer"
                            id="birthday" label="Birthday" name="birthday" type="date"> <label
                            class="peer-data-[validation-required=true]:after:content-['*'] after:text-red-500 peer-invalid:text-red-500 text-sm"
                            for="birthday">Birthday</label></div>
                    <div class="flex flex-col gap-2"></div>
                </div>
                <div class="flex flex-col gap-2">
                    <div class="flex flex-col-reverse gap-2"><input
                            class="p-2 valid:border rounded outline-none invalid:outline invalid:outline-red-600 outline-1 peer"
                            id="amount" label="Amount" name="amount" type="number">
                        <label
                            class="peer-data-[validation-required=true]:after:content-['*'] after:text-red-500 peer-invalid:text-red-500 text-sm"
                            for="amount">Amount</label>
                    </div>
                    <div class="flex flex-col gap-2"></div>
                </div>
                <div class="flex flex-col gap-2">
                    <div class="flex flex-col-reverse gap-2"><input
                            class="p-2 valid:border rounded outline-none invalid:outline invalid:outline-red-600 outline-1 peer"
                            id="range" label="Range" name="range" type="range" min="0" max="100" step="1"> <label
                            class="peer-data-[validation-required=true]:after:content-['*'] after:text-red-500 peer-invalid:text-red-500 text-sm"
                            for="range">Range</label></div>
                    <div class="flex flex-col gap-2"></div>
                </div>
                <div class="p-2 border rounded flex flex-col">
                    <div class="flex flex-col gap-2">
                        <div class="flex flex-col-reverse gap-2"><input
                                class="p-2 valid:border rounded outline-none invalid:outline invalid:outline-red-600 outline-1 peer"
                                id="contact.tel" label="Telephone" name="contact.tel">
                            <label
                                class="peer-data-[validation-required=true]:after:content-['*'] after:text-red-500 peer-invalid:text-red-500 text-sm"
                                for="contact.tel">Telephone</label>
                        </div>
                        <div class="flex flex-col gap-2"></div>
                    </div>
                    <div class="flex flex-col gap-2">
                        <div class="flex flex-col-reverse gap-2"><input
                                class="p-2 valid:border rounded outline-none invalid:outline invalid:outline-red-600 outline-1 peer"
                                id="contact.email.email" label="E-Mail" name="contact.email.email"> <label
                                class="peer-data-[validation-required=true]:after:content-['*'] after:text-red-500 peer-invalid:text-red-500 text-sm"
                                for="contact.email.email">E-Mail</label></div>
                        <div class="flex flex-col gap-2"></div>
                    </div>
                    <div class="flex flex-col gap-2">
                        <div class="flex flex-col-reverse gap-2"><input
                                class="p-2 valid:border rounded outline-none invalid:outline invalid:outline-red-600 outline-1 peer"
                                id="contact.email.confirmEmail" label="Confirm E-Mail"
                                name="contact.email.confirmEmail"> <label
                                class="peer-data-[validation-required=true]:after:content-['*'] after:text-red-500 peer-invalid:text-red-500 text-sm"
                                for="contact.email.confirmEmail">Confirm E-Mail</label></div>
                        <div class="flex flex-col gap-2"></div>
                    </div>
                </div>
                <div class="flex flex-col gap-2">
                    <div class="flex flex-col-reverse gap-2"><select
                            class="p-2 valid:border rounded outline-none invalid:outline invalid:outline-red-600 outline-1 peer"
                            id="pet" name="pet" label="Pet">
                            <option value="">--Please choose an option--</option>
                            <option value="dog">Dog</option>
                            <option value="cat">Cat</option>
                            <option value="hamster">Hamster</option>
                            <option value="parrot">Parrot</option>
                            <option value="spider">Spider</option>
                            <option value="goldfish">Goldfish</option>
                        </select> <label
                            class="peer-data-[validation-required=true]:after:content-['*'] after:text-red-500 text-sm"
                            for="pet">Pet</label></div>
                </div>
                <div class="flex flex-col gap-2">
                    <div class="flex flex-col-reverse gap-2"><select
                            class="p-2 valid:border rounded outline-none invalid:outline invalid:outline-red-600 outline-1 peer"
                            id="fruits" multiple="" name="fruits" label="Fruits">
                            <option value="apple">Apple</option>
                            <option value="banana">Banana</option>
                            <option value="kiwi">Kiwi</option>
                        </select> <label
                            class="peer-data-[validation-required=true]:after:content-['*'] after:text-red-500 text-sm"
                            for="fruits">Fruits</label></div>
                </div>
                <div class="flex flex-col gap-2">
                    <div class="flex flex-col-reverse gap-2"><textarea
                            class="p-2 valid:border rounded outline-none invalid:outline invalid:outline-red-600 outline-1 peer"
                            id="description" label="Description" name="description"></textarea> <label
                            class="peer-data-[validation-required=true]:after:content-['*'] after:text-red-500 text-sm"
                            for="description">Description</label></div>
                    <div class="flex flex-col gap-2"></div>
                </div>
                <fieldset name="monster" class="flex gap-2">
                    <div class="flex flex-col gap-2">
                        <div class="flex flex-col-reverse gap-2"><input
                                class="p-2 valid:border rounded outline-none invalid:outline invalid:outline-red-600 outline-1 peer"
                                id="monster" label="Kraken" name="monster" type="radio" value="kraken"> <label
                                class="peer-data-[validation-required=true]:after:content-['*'] after:text-red-500 peer-invalid:text-red-500 text-sm"
                                for="monster">Kraken</label></div>
                        <div class="flex flex-col gap-2"></div>
                    </div>
                    <div class="flex flex-col gap-2">
                        <div class="flex flex-col-reverse gap-2"><input
                                class="p-2 valid:border rounded outline-none invalid:outline invalid:outline-red-600 outline-1 peer"
                                id="monster" label="Sasquatch" name="monster" type="radio" value="sasquatch"> <label
                                class="peer-data-[validation-required=true]:after:content-['*'] after:text-red-500 peer-invalid:text-red-500 text-sm"
                                for="monster">Sasquatch</label></div>
                        <div class="flex flex-col gap-2"></div>
                    </div>
                    <div class="flex flex-col gap-2">
                        <div class="flex flex-col-reverse gap-2"><input
                                class="p-2 valid:border rounded outline-none invalid:outline invalid:outline-red-600 outline-1 peer"
                                id="monster" label="Mothman" name="monster" type="radio" value="mothman"> <label
                                class="peer-data-[validation-required=true]:after:content-['*'] after:text-red-500 peer-invalid:text-red-500 text-sm"
                                for="monster">Mothman</label></div>
                        <div class="flex flex-col gap-2"></div>
                    </div>
                </fieldset> <span class="text-red-500 text-sm"></span> <button
                    class="p-2 border rounded bg-slate-500">Save</button> <span class="text-gray-500 text-sm">*
                    required</span>
            </form>
        </section>
    </main>
</body>

<script type="importmap">
    {
      "imports": {
        "zod": "/node_modules/zod/lib/index.mjs",
        "@vardario/zod-form-validation": "/node_modules/@vardario/zod-form-validation/lib/browser.js"
      }
    }
</script>

<script type="module">
    import { validateForm, observerValidationErrors } from "@vardario/zod-form-validation";
    import { z } from 'zod';
    const form = document.querySelector('form');
    const inputs = form.querySelectorAll('input,select,textarea');

    inputs.forEach(input => {
        observerValidationErrors(input, errors => {
            const errorMessages = input.parentElement.nextElementSibling;

            errorMessages.replaceChildren(...errors.map(error => {
                const span = document.createElement('span');
                span.innerText = error;
                span.className = 'text-sm text-red-600'
                return span;
            }));
        })
    });

    const petsSchema = z.enum([
        "dog",
        "cat",
        "hamster",
        "parrot",
        "spider",
        "goldfish",
    ]);

    const monsterSchema = z.enum(["kraken", "sasquatch", "mothman"]);
    const fruits = z.enum(["apple", "banana", "kiwi"]);

    const schema = z.object({
        admin: z.boolean().optional(),
        birthday: z.string().optional(),
        givenName: z.string().min(1),
        surname: z.string().min(1),
        contact: z.object({
            tel: z.string(),
            email: z
                .object({
                    email: z.string().email(),
                    confirmEmail: z.string().email(),
                })
                .superRefine(({ email, confirmEmail }, context) => {
                    if (email !== confirmEmail) {
                        context.addIssue({
                            code: z.ZodIssueCode.custom,
                            message: "E-Mail does not match",
                            path: ["confirmEmail"],
                        });
                    }
                }),
        }),
        amount: z.number(),
        range: z.number(),
        pet: petsSchema,
        fruits: z.array(fruits),
        description: z.string(),
        monster: monsterSchema,
    });

    validateForm(form, schema);


</script>

</html>